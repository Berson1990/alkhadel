function autocompe(){this.supplier=function(){$("[name^=SupplierID]").select2({placeholder:"Search for an Supplier Name",ajax:{url:"../../../supplierautocomplete",headers:{"X-CSRF-Token":$("meta[name=_token]").attr("content")},type:"post",data:function(a){var b={SupplierName:a.term};return b},processResults:function(a){return a.status?{results:$.map(a.data,function(a){return{text:a.SupplierName,id:a.SupplierID,comm:a.SupplierCommision,SupType:a.SupplierType}})}:{results:$.map(a.data,function(a){return{text:a.message,id:a.id}})}}}})},this.Customer=function(){$("#CustomerID").select2({placeholder:"Search for an Customer Name",ajax:{url:"../../../autocompleteCustomer",headers:{"X-CSRF-Token":$("meta[name=_token]").attr("content")},type:"post",data:function(a){var b={CustomerName:a.term};return b},processResults:function(a){return a.status?{results:$.map(a.data,function(a){return{text:a.CustomerName,id:a.CustomerID,CutType:a.CustomerType}})}:{results:$.map(a.data,function(a){return{text:a.message,id:a.id}})}}}})},_globalvars={Customer:{checkcustomerexist:function(){return $("[name^=CustomerID]").find("option:selected").length},GetCustomerType:function(){var a=$("[name^=CustomerID] :selected");return!(a.length<1)&&a.data("data").CutType}}},this.Product=function(){$("[name^=ProductID]").select2({placeholder:"Search for an Product Name",ajax:{url:"../../../productautocomplete",headers:{"X-CSRF-Token":$("meta[name=_token]").attr("content")},type:"post",data:function(a){var b={ProductName:a.term};return b},processResults:function(a){return a.status?{results:$.map(a.data,function(a){return{text:a.ProductName,id:a.ProductID,type:a.ProductType,carrying:a.ProductType<1?$("[name^=ProductID]").eq(0).data("local"):$("[name^=ProductID]").eq(0).data("imported")}})}:{results:$.map(a.data,function(a){return{text:a.message,id:a.id}})}}}})},this.Driver=function(){$("#DriverID").select2({placeholder:"Search for an Customer Name",ajax:{url:"../../../driverautocomplete",headers:{"X-CSRF-Token":$("meta[name=_token]").attr("content")},type:"post",data:function(a){var b={DriverName:a.term};return b},processResults:function(a){return a.status?{results:$.map(a.data,function(a){return{text:a.DriverName,id:a.DriverID}})}:{results:$.map(a.data,function(a){return{text:a.message,id:a.id}})}}}})}}function GetCTYpe(a){CustomerType=a,console.log(CustomerType)}function flagChecked(a){var b=document.getElementById(a.closest("tr").id);"check"!=b.className?b.className+="check":b.className=""}$(document).ready(function(){});var sales_bill=function(){var a=new autocompe;a.Customer(),a.Driver(),a.Product(),a.supplier()};sales_bill.prototype.Init=function(){this.SetSelectSelection(),this.IntializeContainerAutocomplete()},sales_bill.prototype.GetTotalOfType=function(a){var d,b=a.closest("td").index(),c=0;a.closest("tbody").find("tr").each(function(){d=$(this).find("td").eq(b).find("input ,label"),c+=d.is(":input")?parseInt(d.val()):parseInt(d.text())}),c=isNaN(c)?0:c,a.closest("table").find("tfoot").find("td").eq(b).find("label span").text("("+c+")")},sales_bill.prototype.SetSelectSelection=function(){var a=0;$("select").each(function(){a=$(this).find("[selected=selected]").val(),$(this).val(a).trigger("chosen:updated")})},sales_bill.prototype.GetTotal=function(a){var b=a.closest("tr").find("[name^=WeightType]:checked").val(),c=a.closest("tr").find("[name^=Weight_]").val(),d=a.closest("tr").find("[name^=ProductPrice]").val(),e=a.closest("tr").find("[name^=Quantity]").val(),f=null;f=b>0?e*d:c*e*d,a.closest("tr").find("[name^=Total]").text(f.toFixed()),this.GetTotalOfType(a.closest("tr").find("[name^=Total]"))},sales_bill.prototype.GetCarring=function(a){var b=$("option:selected",a.closest("tr").find("[name^=ProductID]")).data("data").carrying;"undefined"==typeof b||(a.closest("tr").find("[name^=Carrying]").val((b*a.closest("tr").find("[name^=Quantity]").val()).toFixed(2)),$("[name^=Carrying]").trigger("keyup"))},sales_bill.prototype.GetSalesID=function(){return parms=window.location.pathname.split("/"),parms=parms[parms.length-1]},CustomerType="",sales_bill.prototype.CType=function(){var url="../../../sales/bill/Ctype/"+sales_bill.prototype.GetSalesID();$.ajax({url:url,headers:{"X-CSRF-Token":$("meta[name=_token]").attr("content")},type:"post",dataType:"json",data:$("[name^=move_]").serialize()}).done(function(output){for(var obj=eval(output),type="",i=0;i<obj.length;i++)CType=obj[0].CustomerType;if(output.status)_salesbill.ShowNotfication(output.message,!0),$.each(output.serials,function(a,b){$("#tr_"+b).fadeOut("slow",function(){$(this).remove()})});else{var errors="";$.each(output.message,function(a,b){errors+="* "+b+"</b><br />"}),_salesbill.ShowNotfication(errors,!1)}}).error(function(a){console.log("error response")})},sales_bill.prototype.SalesDelete=function(){var a="../../../sales/bill/delete/"+sales_bill.prototype.GetSalesID();$.ajax({url:a,headers:{"X-CSRF-Token":$("meta[name=_token]").attr("content")},type:"delete",dataType:"json",data:$("[name^=move_]").serialize()}).done(function(a){if(a.status)_salesbill.ShowNotfication(a.message,!0),$.each(a.serials,function(a,b){$("#tr_"+b).fadeOut("slow",function(){$(this).remove()})});else{var b="";$.each(a.message,function(a,c){b+="* "+c+"</b><br />"}),_salesbill.ShowNotfication(b,!1)}}).error(function(a){console.log("error response")})},sales_bill.prototype.DeteteBill=function(){var a="../../../sales/bill/deleteBills/"+sales_bill.prototype.GetSalesID();$.ajax({url:a,headers:{"X-CSRF-Token":$("meta[name=_token]").attr("content")},type:"delete",dataType:"json",data:$("[name^=move_]").serialize()}).done(function(a){if(a.status)_salesbill.ShowNotfication(a.message,!0),$.each(a.serials,function(a,b){$("#tr_"+b).fadeOut("slow",function(){$(this).remove()})});else{var b="";$.each(a.message,function(a,c){b+="* "+c+"</b><br />"}),_salesbill.ShowNotfication(b,!1)}}).error(function(a){console.log("error response")})},sales_bill.prototype.SalesUpdate=function(){var a="../../../sales/bill/update/"+sales_bill.prototype.GetSalesID();$.ajax({url:a,headers:{"X-CSRF-Token":$("meta[name=_token]").attr("content")},type:"post",dataType:"json",data:sales_bill.prototype.GetDataASSerialize()}).done(function(a){if(a.status)_salesbill.ShowNotfication(a.message,!0),a.serials&&$.each(a.serials,function(a,b){$("#tr_"+b).fadeOut("slow",function(){$(this).remove()})});else{var b="";$.each(a.message,function(a,c){b+="* "+c+"</b><br />"}),_salesbill.ShowNotfication(b,!1)}}).error(function(a){console.log("error response")})},sales_bill.prototype.GetDataASSerialize=function(){var a={};return a.master=$("#tblMaster").find("input ,select").serialize(),$("#tblDetails tr").each(function(){a[$(this).attr("data-text")]=$(this).find("input ,select").serialize()}),a},sales_bill.prototype.ShowNotfication=function(a,b){var c=$("#error-box");$("#error-box").is(":visible")&&c.slideUp(),b?(c.removeClass("alert-danger"),c.addClass("alert-success")):(c.removeClass("alert-success"),c.addClass("alert-danger")),c.find("p").html(a),c.slideDown(),timeOut=window.setTimeout(function(){c.slideUp()},1e4)},sales_bill.prototype.IntializeContainerAutocomplete=function(){function c(a){if(a.loading)return"No Result";var b='<div class="clearfix"><div class="col-md-6"><label class="form-control btn-info">LN : '+a.lnum+'</label></div><div class="col-md-6"><label class="form-control btn-primary">IN : '+a.intnum+"</label></div></div>";return b}function d(a){return a.lnum||a.text}var a=null,b=null;$("[name^=ContainerID]").on("select2:open",function(c){a=c.currentTarget,b=a.name.split("_")[1]}).select2({dropdownCssClass:"widedrop",ajax:{url:"../../../suppliercontainer",headers:{"X-CSRF-Token":$("meta[name=_token]").attr("content")},type:"post",dataType:"json",delay:250,data:function(b){var c={SupplierID:$(a).closest("tr").find("[name^=SupplierID]").val(),LocalNum:b.term};return c},processResults:function(b,c){return $(a).find("option").not("[value=0]").remove(),$(a).val(0).trigger("change"),b.status?{results:$.map(b.data,function(a){return{lnum:a.ContainerLocalNum,intnum:a.ContainerIntNum,id:a.ContainerID}})}:{results:{lnum:"No Data",intnum:"No Data",id:"0"}}},cache:!0},escapeMarkup:function(a){return a},templateResult:c,templateSelection:d})},$(document).ready(function(){_salesbill=new sales_bill,_salesbill.Init(),$("[name^=WeightType]").change(function(){$(this).val()>0?$(this).closest("tr").find("[name^=Weight_]").val("1").toggleClass("hidden"):$(this).closest("tr").find("[name^=Weight_]").val("1").toggleClass("hidden"),_salesbill.GetTotal($(this))}),$("[name^=Weight_],[name^=Quantity],[name^=ProductPrice]").keyup(function(){_salesbill.GetTotal($(this)),_salesbill.GetTotalOfType($(this))}),$("#moveall").change(function(){$("input[id=moveall]:checked").length>0?$("[name^=move_]").prop("checked",!0):$("[name^=move_]").prop("checked",!1)}),$("[name^=move_]").change(function(){var a=$("input[name^=move_]").length;$("input[name^=move_]:checked").length<a?$("#moveall").prop("checked",!1):$("#moveall").prop("checked",!0)}),$("[name^=ProductID]").change(function(){_salesbill.GetCarring($(this))}),$("[name^=Quantity]").keyup(function(){_salesbill.GetCarring($(this)),_salesbill.GetTotalOfType($(this)),$("[name^=Carrying]").trigger("keyup")}),$("[name^=Commision]").keyup(function(){_salesbill.GetTotalOfType($(this))}),$("[name^=Carrying]").keyup(function(){_salesbill.GetTotalOfType($(this))}),$("[name^=SupplierID]").change(function(){var a=$(this).closest("tr");a.find("[name^=Commision]").val(a.find("[name^=SupplierID] option:selected").data("data").comm),$("[name^=Commision]").trigger("keyup"),a.find("[name^=ContainerID]").val(0).trigger("change")}),$("#clossalespage ,#updatesales ,#deletesales ,#DeteteMasterSales").click(function(){var a=$(this).attr("data-flag");$("#confirmBox").slideDown(function(){$("#confirmYES").attr("data-flag",a)}),$("#confirmBox").slideDown(function(){$("#confirmYES").attr("data-flag",a)}),$("#confirmYES").click(function(){$("#confirmBox").slideUp()}),$("#confirmNO").click(function(){$("#confirmBox").slideUp()})}),$("#confirmYES").click(function(){switch($(this).attr("data-flag")){case"close":break;case"update":_salesbill.SalesUpdate();break;case"delete":_salesbill.SalesDelete();break;case"detetallbills":_salesbill.DeteteBill(),$(".form-control").val(0)}}),$("#clossalespage").click(function(){self.close()}),_salesbill.CType()}),sales_bill.prototype.ChangeCustomerStatus=function(a){_globalvars.Customer.GetCustomerType()>0?(console.log(_globalvars.Customer.GetCustomerType()),$("#tr_masterextra").attr("class","hidden_a4p"),alert("worging")):_globalvars.Customer.GetCustomerType()<2?($(".southegypt").hide(),$(".agency").show(),$("#tr_masterextra").removeAttr("class")):($(".southegypt").show(),$(".agency").hide(),$("#tr_masterextra").removeAttr("class"))},$("#CustomerID").change(function(){}),gettype="",gettype=$("#CustomerID").attr("title"),gettype=$("[name=CustomerID]").find("option:selected").attr("title"),gettype=eval(gettype),console.log(gettype),gettype<1?($(".local").prop("disabled",!0),$("#DriverID").prop("disabled",!0),$("#custdylocal").prop("disabled",!0)):gettype<2?($(".upper").prop("disabled",!0),$(".custody").prop("disabled",!1),$("#DriverID").prop("disabled",!0),$(".upper").prop("disabled",!1),$(".custody").prop("disabled",!1),$("#DriverID").prop("disabled",!1)):($(".upper").prop("disabled",!0),$(".custody").prop("disabled",!1),$("#DriverID").prop("disabled",!0),$(".upper").prop("disabled",!0),$("#DriverID").prop("disabled",!0)),$("#CustomerID").change(function(){_globalvars.Customer.GetCustomerType()<1?(console.log("LocalCustomer"),$(".local").prop("disabled",!0),$("#DriverID").prop("disabled",!0),$("#custdylocal").prop("disabled",!0)):_globalvars.Customer.GetCustomerType()<2?(console.log("abord customer"),$(".upper").prop("disabled",!1),$(".custody").prop("disabled",!1),$("#DriverID").prop("disabled",!1)):(console.log("upper Customer"),$(".upper").prop("disabled",!0),$(".custody").prop("disabled",!1),$("#DriverID").prop("disabled",!0))});